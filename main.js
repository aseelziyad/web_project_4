!function(){"use strict";class e{constructor(e){var t,s;s=e=>{"Escape"===e.key&&this.close()},(t="_handleEscapeClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popup=document.querySelector(e),this._handleEscapeClose=this._handleEscapeClose.bind(this),this._handleBackgroundClose=this._handleBackgroundClose.bind(this),this._handleCloseOnCloseButtonClick=this._handleCloseOnCloseButtonClick.bind(this)}open(){this._popup.classList.add("popup_active"),this._setDocumentEventListeners()}close(){this._popup.classList.remove("popup_active"),this._removeDocumentEventListeners()}_handleBackgroundClose(e){e.target.classList.contains("popup_active")&&this.close()}_handleCloseOnCloseButtonClick(){this.close()}_setDocumentEventListeners(){document.addEventListener("keydown",this._handleEscapeClose),document.addEventListener("mousedown",this._handleBackgroundClose)}_removeDocumentEventListeners(){document.removeEventListener("keydown",this._handleEscapeClose),document.removeEventListener("mousedown",this._handleBackgroundClose)}setEventListeners(){this._popup.querySelector(".popup__close").addEventListener("click",this._handleCloseOnCloseButtonClick)}}class t extends e{constructor(e,t,s,n){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._popup.querySelectorAll(".popup__input"),this._button=this._form.querySelector(".popup__submit-btn"),this._buttonText=n,this._validator=s}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}showLoading(){this._button.textContent="Saving..."}hideLoading(){this._button.textContent="Save"}open(){this._validator.resetValidation(),super.open()}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())}))}}class s{constructor(e,t,s){let{data:n,handleCardClick:r,handleDeleteCard:o,handleLikeIcon:i}=e;var a,l;l=e=>{this._likes=e,this._renderLikes()},(a="updateLike")in this?Object.defineProperty(this,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):this[a]=l,this._cardSelector=t,this._name=n.name,this._link=n.link,this._id=n._id,this._likes=n.likes,this._userId=s,this._ownerId=n.owner._id,this._handleImagePopupOpen=r,this._handleDeleteCard=o,this._handleLikeIcon=i}_getCardTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".photograph").cloneNode(!0)}_setDeleteButton(){this._ownerId!==this._userId&&(this._deleteCardButton.style.display="none")}deleteCard(e){this._element.remove(),this._element=null}checkLikes(){return this._likes.some((e=>e._id==this._userId))}_renderLikes(){this._likeCounter.textContent=this._likes.length,this.checkLikes()?this._likeCardButton.classList.add("photograph__like-button_active"):this._likeCardButton.classList.remove("photograph__like-button_active")}_setEventListeners(){this._deleteCardButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)})),this._likeCardButton.addEventListener("click",(()=>{this._handleLikeIcon(this._id)})),this._element.querySelector(".photograph__post").addEventListener("click",this._handleImagePopupOpen)}generateCard(){return this._element=this._getCardTemplate(),this._element.querySelector(".photograph__title").textContent=this._name,this._cardImage=this._element.querySelector(".photograph__post"),this._deleteCardButton=this._element.querySelector(".photograph__delete-button"),this._likeCardButton=this._element.querySelector(".photograph__like-button"),this._likeCounter=this._element.querySelector(".photograph__like-counter"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setDeleteButton(),this._renderLikes(),this._setEventListeners(),this._element}}class n{constructor(e,t){this.formElement=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this.formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this.formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputElements=[...this.formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this.formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this.formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_hasInvalidInput(){return this._inputElements.some((e=>!e.validity.valid))}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}}document.querySelector(".popup_edit-profile"),document.querySelector(".popup_avatar");const r=document.querySelector("#input-name"),o=document.querySelector("#input-about"),i=document.querySelector("#form-edit"),a=document.querySelector("#form-avatar"),l=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__avatar-button"),c=document.querySelector(".profile__add-button"),u=(document.querySelector(".profile__title"),document.querySelector(".profile__subtitle"),document.querySelector("#card-template").content,document.querySelector(".photographs"),document.querySelector(".popup_add-card")),d=(u.querySelector("#input-title"),u.querySelector("#input-image-link"),u.querySelector("#form-add")),_={inputSelector:".popup__input",submitButtonSelector:".popup__submit-btn",inactiveButtonClass:"popup__submit-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visiable"},p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._getResponseData)}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._getResponseData)}setUserInfo(e){let{name:t,about:s,avatar:n}=e;return fetch("".concat(this._baseUrl,"/users/me "),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s,avatar:n})}).then(this._getResponseData)}createCard(e){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then(this._getResponseData)}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._getResponseData)}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"}).then(this._getResponseData)}disLikeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._getResponseData)}setUserAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then(this._getResponseData)}_getResponseData(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"6edae45a-96e2-41b1-a788-2616fd5c518a","Content-Type":"application/json"}});let m;Promise.all([p.getInitialCards(),p.getUserInfo()]).then((e=>{let[t,s]=e;m=s._id,b.renderer(t),L.setUserInfo({name:s.name,about:s.about}),L.setUserAvatar(s.avatar)})).catch((e=>{console.log(e)}));const v=new class extends e{constructor(e){super(e),this._popupImageCard=this._popup.querySelector(".popup__image-card"),this._popupImageTitle=this._popup.querySelector(".popup__image-title")}openImage(e,t){this._popupImageTitle.textContent=e,this._popupImageCard.src=t,this._popupImageCard.alt=e,super.open()}}(".popup_image");v.setEventListeners();const g=new class extends e{constructor(e){super(e),this._form=this._popup.querySelector(".popup__form")}setAction(e){this._handleSubmit=e}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}}(".popup_delete");function C(e){let{data:t}=e;const n=new s({data:t,handleCardClick:()=>{v.openImage(t.name,t.link)},handleLikeIcon:e=>{n.checkLikes()?p.disLikeCard(e).then((e=>{n.updateLike(e.likes)})).catch((e=>{console.log(e)})):p.likeCard(e).then((e=>{n.updateLike(e.likes)})).catch((e=>{console.log(e)}))},handleDeleteCard:e=>{g.open(),g.setAction((()=>{p.deleteCard(e).then((e=>{n.deleteCard(),g.close()})).catch((e=>{console.log(e)}))}))}},"#card-template",m);return n.generateCard()}g.setEventListeners();const b=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderer(e){e.forEach((e=>{this._renderer(e)}))}}({renderer:e=>{b.addItem(C({data:e}))}},".photographs"),E=new n(_,i);E.enableValidation();const L=new class{constructor(e){let{userNameSelector:t,userInfoSelector:s,userAvatarSelector:n}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._avatar=document.querySelector(n)}getUserAvatar(){return{avatar:this._avatar.src}}setUserAvatar(e){this._avatar.src=e}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._about.textContent=s}}({userNameSelector:".profile__title",userInfoSelector:".profile__subtitle",userAvatarSelector:".profile__avatar"}),S=new t(".popup_edit-profile",(function(e){S.showLoading(),p.setUserInfo(e).then((e=>{L.setUserInfo(e),S.close()})).catch((e=>{console.log(e)})).finally((()=>{S.hideLoading()}))}),E);S.setEventListeners();const k=new n(_,a);k.enableValidation();const f=new t(".popup_avatar",(function(e){f.showLoading(),p.setUserAvatar(e.avatar).then((t=>{L.setUserAvatar(e.avatar),f.close()})).catch((e=>{console.log(e)})).finally((()=>{f.hideLoading()}))}),k);f.setEventListeners();const y=new n(_,d);y.enableValidation();const I=new t(".popup_add-card",(function(e){let{name:t,link:s}=e;I.showLoading();const n={name:t,link:s};p.createCard(n).then((e=>{b.addItem(C({data:e})),I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.hideLoading()}))}),y);I.setEventListeners(),l.addEventListener("click",(function(){const{name:e,about:t}=L.getUserInfo();r.value=e,o.value=t,S.open()})),c.addEventListener("click",(function(){I.open()})),h.addEventListener("click",(function(){f.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixNQUFNZ0YsRUFBa0IsSUFBSTVLLEVBQzFCLGlCQU1GLFNBQWdDMEIsR0FDOUJrSixFQUFnQjFKLGNBRWhCcUYsRUFDR3FCLGNBQWNsRyxFQUFLeUYsUUFDbkJMLE1BQU1nQixJQUNMWSxFQUFTZCxjQUFjbEcsRUFBS3lGLFFBQzVCeUQsRUFBZ0IvTCxXQUVqQjhKLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE1BRWI4QixTQUFRLEtBQ1BFLEVBQWdCeEosbUJBakJwQnVKLEdBRUZDLEVBQWdCN0ssb0JBeUJoQixNQUFNOEssRUFBbUIsSUFBSTVHLEVBQWNDLEVBQVVvQyxHQUNyRHVFLEVBQWlCakYsbUJBRWpCLE1BQU1rRixFQUFlLElBQUk5SyxFQUN2QixtQkFNRixZQUE4QyxJQUFoQixLQUFFZ0IsRUFBRixLQUFRb0IsR0FBUSxFQUM1QzBJLEVBQWE1SixjQUViLE1BQU1RLEVBQU8sQ0FDWFYsS0FBTUEsRUFDTm9CLEtBQU1BLEdBRVJtRSxFQUNHaUIsV0FBVzlGLEdBQ1hvRixNQUFNcEYsSUFDTDhHLEVBQVNxQixRQUFRckMsRUFBVyxDQUFFOUYsS0FBQUEsS0FDOUJvSixFQUFhak0sV0FFZDhKLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE1BRWI4QixTQUFRLEtBQ1BJLEVBQWExSixtQkFyQmpCeUosR0FFRkMsRUFBYS9LLG9CQTRCYm1HLEVBQWtCckcsaUJBQWlCLFNBN0VuQyxXQUNFLE1BQU0sS0FBRW1CLEVBQUYsTUFBUWtHLEdBQVV3QixFQUFTMUIsY0FDakNsQixFQUFVN0UsTUFBUUQsRUFDbEIrRSxFQUFXOUUsTUFBUWlHLEVBQ25CdUQsRUFBaUJwTCxVQTBFbkIrRyxFQUFpQnZHLGlCQUFpQixTQU5sQyxXQUNFaUwsRUFBYXpMLFVBTWY4RyxFQUFpQnRHLGlCQUFpQixTQTVDbEMsV0FDRStLLEVBQWdCdkwsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZUJhY2tncm91bmRDbG9zZSA9IHRoaXMuX2hhbmRsZUJhY2tncm91bmRDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZUNsb3NlT25DbG9zZUJ1dHRvbkNsaWNrID0gdGhpcy5faGFuZGxlQ2xvc2VPbkNsb3NlQnV0dG9uQ2xpY2suYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX2FjdGl2ZVwiKTtcbiAgICB0aGlzLl9zZXREb2N1bWVudEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfYWN0aXZlXCIpO1xuICAgIHRoaXMuX3JlbW92ZURvY3VtZW50RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NhcGVDbG9zZSA9IChldmVudCkgPT4ge1xuXG5cbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZUJhY2tncm91bmRDbG9zZShldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfYWN0aXZlXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZUNsb3NlT25DbG9zZUJ1dHRvbkNsaWNrICgpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgfVxuXG4gIF9zZXREb2N1bWVudEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUJhY2tncm91bmRDbG9zZSk7XG4gIH1cblxuICBfcmVtb3ZlRG9jdW1lbnRFdmVudExpc3RlbmVycygpIHtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVCYWNrZ3JvdW5kQ2xvc2UpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKTtcbiAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2xvc2VPbkNsb3NlQnV0dG9uQ2xpY2sgKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG4gXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0LCB2YWxpZGF0b3IsIGJ1dHRvblRleHQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcbiAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3N1Ym1pdC1idG5cIik7XG4gICAgdGhpcy5fYnV0dG9uVGV4dCA9IGJ1dHRvblRleHQ7XG5cbiAgICB0aGlzLl92YWxpZGF0b3IgPSB2YWxpZGF0b3I7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBmb3JtVmFsdWVzO1xuICB9XG5cbiAgc2hvd0xvYWRpbmcoKSB7XG4gICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgfVxuICBcbiAgaGlkZUxvYWRpbmcoKSB7XG4gICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gIH0gXG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl92YWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG5cbiAgXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuXG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDYXJkLCBoYW5kbGVMaWtlSWNvbiB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICB1c2VySWRcbiAgKSB7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlUG9wdXBPcGVuID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uID0gaGFuZGxlTGlrZUljb247XG4gIH1cblxuICBfZ2V0Q2FyZFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5waG90b2dyYXBoXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgX3NldERlbGV0ZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICB0aGlzLl9kZWxldGVDYXJkQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB9XG4gIH1cblxuICBkZWxldGVDYXJkKF9pZCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBjaGVja0xpa2VzKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChwZXJzb24pID0+IHBlcnNvbi5faWQgPT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG4gIHVwZGF0ZUxpa2UgPSAobmV3TGlrZXMpID0+IHtcbiAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH07XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIHRoaXMuX2xpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgIGlmICh0aGlzLmNoZWNrTGlrZXMoKSkge1xuICAgICAgdGhpcy5fbGlrZUNhcmRCdXR0b24uY2xhc3NMaXN0LmFkZChcInBob3RvZ3JhcGhfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUNhcmRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcInBob3RvZ3JhcGhfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZGVsZXRlQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZCk7XG4gICAgfSk7XG4gICAgdGhpcy5fbGlrZUNhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKHRoaXMuX2lkKTtcbiAgICB9KTtcbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5waG90b2dyYXBoX19wb3N0XCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUltYWdlUG9wdXBPcGVuKTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0Q2FyZFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvZ3JhcGhfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9ncmFwaF9fcG9zdFwiKTtcbiAgICB0aGlzLl9kZWxldGVDYXJkQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucGhvdG9ncmFwaF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLl9saWtlQ2FyZEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLnBob3RvZ3JhcGhfX2xpa2UtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucGhvdG9ncmFwaF9fbGlrZS1jb3VudGVyXCJcbiAgICApO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldERlbGV0ZUJ1dHRvbigpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICBcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcblxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG5cbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbXG4gICAgICAuLi50aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXG4gICAgXTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxlbWVudHMuc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9lZGl0LXByb2ZpbGVcIik7XG5leHBvcnQgY29uc3QgcG9wdXBBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX2F2YXRhclwiKTtcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2lucHV0LW5hbWVcIik7XG5leHBvcnQgY29uc3QgYWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW5wdXQtYWJvdXRcIik7XG5leHBvcnQgY29uc3QgZWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0tZWRpdFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtLWF2YXRhclwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2F2YXRhci1idXR0b25cIlxuKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlU3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xuXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZUNsYXNzID0gXCIucG9wdXBfaW1hZ2VcIjtcbmV4cG9ydCBjb25zdCBwb3B1cERlbGV0ZSA9IFwiLnBvcHVwX2RlbGV0ZVwiO1xuXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQ7XG5leHBvcnQgY29uc3QgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvZ3JhcGhzXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfYWRkLWNhcmRcIik7XG5leHBvcnQgY29uc3QgdGl0bGVJbnB1dCA9IHBvcHVwQWRkQ2FyZC5xdWVyeVNlbGVjdG9yKFwiI2lucHV0LXRpdGxlXCIpO1xuZXhwb3J0IGNvbnN0IGltYWdlTGlua0lucHV0ID0gcG9wdXBBZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIjaW5wdXQtaW1hZ2UtbGlua1wiKTtcbmV4cG9ydCBjb25zdCBhZGRGb3JtID0gcG9wdXBBZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1hZGRcIik7XG4vL19fX19fX19fX19fX19fX19fX19fX190ZW1wbGF0ZS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLy9cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYWJsZVwiLFxufTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5pbXBvcnQge1xuICBzZXR0aW5ncyxcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIHByb2ZpbGVBZGRCdXR0b24sXG4gIGF2YXRhckVkaXRCdXR0b24sXG4gIGVkaXRGb3JtLFxuICBhdmF0YXJGb3JtLFxuICBhZGRGb3JtLFxuICBuYW1lSW5wdXQsXG4gIGFib3V0SW5wdXQsXG4gIHBvcHVwSW1hZ2VDbGFzcyxcbiAgcG9wdXBEZWxldGUsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNmVkYWU0NWEtOTZlMi00MWIxLWE3ODgtMjYxNmZkNWM1MThhXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxubGV0IHVzZXJJZDtcbi8vIGxldCBuZXdJbmZvID0ge307XG5cblByb21pc2UuYWxsKFthcGkuZ2V0SW5pdGlhbENhcmRzKCksIGFwaS5nZXRVc2VySW5mbygpXSlcbiAgLnRoZW4oKFtjYXJkc0RhdGEsIHVzZXJEYXRhXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgICBjYXJkTGlzdC5yZW5kZXJlcihjYXJkc0RhdGEpO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICBhYm91dDogdXNlckRhdGEuYWJvdXQsXG4gICAgfSk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuLy8tLS0tLS0tLSBjcmVhdGUgY2FyZHNcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cEltYWdlQ2xhc3MpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoU3VibWl0KHBvcHVwRGVsZXRlKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKHsgZGF0YSB9KSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICB7XG4gICAgICBkYXRhLFxuICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XG4gICAgICAgIGltYWdlUG9wdXAub3BlbkltYWdlKGRhdGEubmFtZSwgZGF0YS5saW5rKTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVMaWtlSWNvbjogKGlkKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkLmNoZWNrTGlrZXMoKTtcbiAgICAgICAgaWYgKGlzTGlrZWQpIHtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5kaXNMaWtlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlKHJlcy5saWtlcyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmxpa2VDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2UocmVzLmxpa2VzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChpZCkgPT4ge1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xuXG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmRlbGV0ZUNhcmQoaWQpXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xuICAgICAgICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9LFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICB1c2VySWRcbiAgKTtcbiAgLy90aGlzLl9lbGVtZW50XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICBjYXJkTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQoeyBkYXRhIH0pKTtcbiAgICB9LFxuICB9LFxuICBcIi5waG90b2dyYXBoc1wiXG4pO1xuXG4vLyAtLS0tLS0gUHJvZmlsZVxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZWRpdEZvcm0pO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHVzZXJOYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHVzZXJJbmZvU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIsXG4gIHVzZXJBdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXG59KTtcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIi5wb3B1cF9lZGl0LXByb2ZpbGVcIixcbiAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQsXG4gIGVkaXRGb3JtVmFsaWRhdG9yXG4pO1xuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChkYXRhKSB7XG4gIGVkaXRQcm9maWxlUG9wdXAuc2hvd0xvYWRpbmcoKTtcbiAgYXBpXG4gICAgLnNldFVzZXJJbmZvKGRhdGEpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLmhpZGVMb2FkaW5nKCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRCdXR0b24oKSB7XG4gIGNvbnN0IHsgbmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XG4gIGFib3V0SW5wdXQudmFsdWUgPSBhYm91dDtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59XG4vLyBfX19fX19fX0F2YXRhclxuXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGF2YXRhckZvcm0pO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIi5wb3B1cF9hdmF0YXJcIixcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCxcbiAgYXZhdGFyRm9ybVZhbGlkYXRvclxuKTtcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGRhdGEpIHtcbiAgZWRpdEF2YXRhclBvcHVwLnNob3dMb2FkaW5nKCk7XG5cbiAgYXBpXG4gICAgLnNldFVzZXJBdmF0YXIoZGF0YS5hdmF0YXIpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihkYXRhLmF2YXRhcik7XG4gICAgICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdEF2YXRhclBvcHVwLmhpZGVMb2FkaW5nKCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckJ1dHRvbigpIHtcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbn1cblxuLy8gLS0tLS0tLS0tQWRkIENhcmRcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhZGRGb3JtKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIucG9wdXBfYWRkLWNhcmRcIixcbiAgaGFuZGxlQ2FyZEZvcm1TdWJtaXQsXG4gIGFkZEZvcm1WYWxpZGF0b3Jcbik7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlQ2FyZEZvcm1TdWJtaXQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgYWRkQ2FyZFBvcHVwLnNob3dMb2FkaW5nKCk7XG5cbiAgY29uc3QgZGF0YSA9IHtcbiAgICBuYW1lOiBuYW1lLFxuICAgIGxpbms6IGxpbmssXG4gIH07XG4gIGFwaVxuICAgIC5jcmVhdGVDYXJkKGRhdGEpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oY3JlYXRlQ2FyZCh7IGRhdGEgfSkpO1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZENhcmRQb3B1cC5oaWRlTG9hZGluZygpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRCdXR0b24oKSB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0gZXZlbnRMaXN0ZW5lcnNcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVFZGl0QnV0dG9uKTtcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUFkZEJ1dHRvbik7XG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBdmF0YXJCdXR0b24pO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIFxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2VEYXRhKTtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZURhdGEpO1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCwgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUgYCx7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG5cbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZURhdGEpO1xuICB9XG5cbiAgY3JlYXRlQ2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2VEYXRhKTtcbiAgfVxuXG4gICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2VEYXRhKTtcbiAgIH1cbiAgXG4gICBsaWtlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZURhdGEpO1xuICAgfVxuICBcbiAgZGlzTGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2VEYXRhKTtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoaW1hZ2VMaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5XG4gICAgICAgICh7IGF2YXRhcjogaW1hZ2VMaW5rIH0pLFxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2VEYXRhKTtcbiAgfVxuXG4gIF9nZXRSZXNwb25zZURhdGEocmVzKSB7XG4gICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApOyBcbiAgICB9XG4gICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gIH1cbn1cblxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZUNhcmQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZS1jYXJkXCIpO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlLXRpdGxlXCIpO1xuICB9XG5cbiAgb3BlbkltYWdlKG5hbWUsIGxpbmspIHtcbiAgICB0aGlzLl9wb3B1cEltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2VDYXJkLnNyYyA9IGxpbms7XG4gICAgdGhpcy5fcG9wdXBJbWFnZUNhcmQuYWx0ID0gbmFtZTtcblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB9XG5cbiAgICBzZXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcbiAgICB9XG5cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgfVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICAvLyB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIHJlbmRlcmVyKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZVNlbGVjdG9yLCB1c2VySW5mb1NlbGVjdG9yLCB1c2VyQXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySW5mb1NlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VyQXZhdGFyKCkge1xuICAgIHJldHVybiB7XG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhci5zcmNcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihpbWFnZUxpbmspIHtcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gaW1hZ2VMaW5rO1xuICB9XG4gIC8vICAtLSAgcmV0dXJucyBhbiBvYmplY3Qgd2l0aCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlci5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIC8vICAtLS0tLXRha2VzIG5ldyB1c2VyIGRhdGEgYW5kIGFkZHMgaXQgb24gdGhlIHBhZ2VcbiAgc2V0VXNlckluZm8oe25hbWUsIGFib3V0fSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJQb3B1cCIsImNvbnN0cnVjdG9yIiwicG9wdXBTZWxlY3RvciIsImV2ZW50Iiwia2V5IiwidGhpcyIsImNsb3NlIiwiX3BvcHVwIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwiYmluZCIsIl9oYW5kbGVCYWNrZ3JvdW5kQ2xvc2UiLCJfaGFuZGxlQ2xvc2VPbkNsb3NlQnV0dG9uQ2xpY2siLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiX3NldERvY3VtZW50RXZlbnRMaXN0ZW5lcnMiLCJyZW1vdmUiLCJfcmVtb3ZlRG9jdW1lbnRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwidmFsaWRhdG9yIiwiYnV0dG9uVGV4dCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J1dHRvbiIsIl9idXR0b25UZXh0IiwiX3ZhbGlkYXRvciIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJmb3JFYWNoIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJzaG93TG9hZGluZyIsInRleHRDb250ZW50IiwiaGlkZUxvYWRpbmciLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldCIsIkNhcmQiLCJjYXJkU2VsZWN0b3IiLCJ1c2VySWQiLCJkYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VJY29uIiwibmV3TGlrZXMiLCJfbGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX25hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJsaWtlcyIsIl91c2VySWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2hhbmRsZUltYWdlUG9wdXBPcGVuIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGxlTGlrZUljb24iLCJfZ2V0Q2FyZFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXREZWxldGVCdXR0b24iLCJfZGVsZXRlQ2FyZEJ1dHRvbiIsInN0eWxlIiwiZGlzcGxheSIsImRlbGV0ZUNhcmQiLCJfZWxlbWVudCIsImNoZWNrTGlrZXMiLCJzb21lIiwicGVyc29uIiwiX2xpa2VDb3VudGVyIiwibGVuZ3RoIiwiX2xpa2VDYXJkQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZ2VuZXJhdGVDYXJkIiwiX2NhcmRJbWFnZSIsInNyYyIsImFsdCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJfaW5wdXRFbGVtZW50cyIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsIm5hbWVJbnB1dCIsImFib3V0SW5wdXQiLCJlZGl0Rm9ybSIsImF2YXRhckZvcm0iLCJwcm9maWxlRWRpdEJ1dHRvbiIsImF2YXRhckVkaXRCdXR0b24iLCJwcm9maWxlQWRkQnV0dG9uIiwicG9wdXBBZGRDYXJkIiwiYWRkRm9ybSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsIl9nZXRSZXNwb25zZURhdGEiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJhdmF0YXIiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImNyZWF0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc0xpa2VDYXJkIiwic2V0VXNlckF2YXRhciIsImltYWdlTGluayIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJhdXRob3JpemF0aW9uIiwiYWxsIiwiY2FyZHNEYXRhIiwidXNlckRhdGEiLCJjYXJkTGlzdCIsInJlbmRlcmVyIiwidXNlckluZm8iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJpbWFnZVBvcHVwIiwiX3BvcHVwSW1hZ2VDYXJkIiwiX3BvcHVwSW1hZ2VUaXRsZSIsIm9wZW5JbWFnZSIsImRlbGV0ZUNhcmRQb3B1cCIsInNldEFjdGlvbiIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJldnQiLCJjYXJkIiwidXBkYXRlTGlrZSIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIml0ZW1zIiwiaXRlbSIsImVkaXRGb3JtVmFsaWRhdG9yIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJJbmZvU2VsZWN0b3IiLCJ1c2VyQXZhdGFyU2VsZWN0b3IiLCJfYWJvdXQiLCJfYXZhdGFyIiwiZ2V0VXNlckF2YXRhciIsImVkaXRQcm9maWxlUG9wdXAiLCJmaW5hbGx5IiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImVkaXRBdmF0YXJQb3B1cCIsImFkZEZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9